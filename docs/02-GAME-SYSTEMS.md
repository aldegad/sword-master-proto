# 소드마스터 - 게임 시스템

## 1) 현재 프로토타입 범위

현재 게임은 **Pixi.js 기반 턴제 카드 전투 프로토타입**입니다.
복잡한 장비/인챈트/레벨링 시스템은 아직 포함하지 않고, 웨이브 생존 루프에 집중합니다.

- 전투 모드: 웨이브 생존 (무한 진행)
- 플레이 방식: 카드 사용 + 턴 종료
- 승패 조건: HP 0이면 패배, 명시적 엔딩 없음

## 2) 플레이어 자원

| 자원 | 기본값 | 동작 |
|------|--------|------|
| HP | 80 | 0이 되면 게임 오버 |
| 마나 | 3 | 턴 시작 시 최대치로 회복 |
| 방어 | 0 | 적 공격 피해를 먼저 흡수, 턴 시작 시 0으로 초기화 |
| 골드 | 0 | 웨이브 클리어 보상(기록용) |

## 3) 카드 시스템

카드는 `공격(attack)` / `방어(defend)` 두 종류입니다.

| 카드 | 타입 | 코스트 | 효과 |
|------|------|--------|------|
| 베기 | 공격 | 1 | 적 1명에게 9 피해 |
| 찌르기 | 공격 | 1 | 적 1명에게 7 피해 |
| 강타 | 공격 | 2 | 적 1명에게 16 피해 |
| 가드 | 방어 | 1 | 방어 +8 |
| 철벽 | 방어 | 2 | 방어 +14 |

공격 카드는 현재 버전에서 항상 **가장 앞의 생존 적 1명**을 대상으로 합니다.

## 4) 덱/손패 규칙

- 시작 덱 구성
- 베기 x4
- 찌르기 x3
- 강타 x2
- 가드 x3
- 철벽 x2

동작 규칙:
- 턴 시작 시 손패가 5장이 될 때까지 드로우
- 덱이 비면 버림 더미를 셔플해 덱으로 재사용
- 카드 사용 후 해당 카드는 버림 더미로 이동
- 웨이브 클리어 시 손패/버림/덱을 합쳐 셔플 후 다음 웨이브 시작

## 5) 적/웨이브 시스템

적 수 공식:

```text
min(1 + floor((wave - 1) / 2), 3)
```

- 웨이브 1~2: 1명
- 웨이브 3~4: 2명
- 웨이브 5+: 3명(최대)

적 스탯은 웨이브와 슬롯(index)에 따라 증가합니다.
- HP: `26 + wave * 7 + index * 6`
- ATK: `7 + floor(wave * 1.4) + index`
- Delay: `2 + (index % 2)`
- Reward: `4 + wave`

## 6) 턴/대기턴 규칙

카드 1장 사용 또는 턴 종료 시:
- 모든 생존 적의 대기턴(delay) -1
- delay가 0 이하인 적은 즉시 공격
- 공격 후 적 delay는 delayMax로 리셋

즉, 공격을 많이 하더라도 적 행동 타이밍이 빨라질 수 있으므로
방어 카드 운영이 필요합니다.

## 7) 피해 계산

플레이어 피격 처리:

```text
흡수량 = min(현재 방어, 적 공격력)
실피해 = 적 공격력 - 흡수량
HP -= 실피해
```

- 방어가 먼저 소모됩니다.
- HP가 0 이하가 되면 즉시 패배 상태로 전환됩니다.

## 8) 웨이브 클리어/패배

웨이브 클리어 조건:
- 생존 적 수가 0이 되면 즉시 클리어
- 해당 웨이브 적 보상 골드 합산
- 웨이브 +1 후 다음 웨이브 시작

패배 조건:
- 플레이어 HP가 0
- 오버레이와 재시작 버튼 표시

## 9) 현재 미구현 항목

아래는 과거 기획에 있었지만 현재 프로토타입에 **미구현**인 요소입니다.

- 검 장착/내구도 시스템
- 타깃 수동 선택
- 버프/디버프 상태이상
- 상점/보상 선택 UI
- 메타 성장(레벨/패시브)

문서/룰북은 현재 구현 범위를 기준으로 유지해야 합니다.
